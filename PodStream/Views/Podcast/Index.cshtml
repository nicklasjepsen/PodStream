@model PodStream.Models.Podcast

@{
    ViewBag.Title = "Podcast Feed";
}

<h1>Vælg en kanal og et program</h1>
<div class="col-md-2">
    @Html.DropDownListFor(x => x.SelectedChannel, new SelectList(Model.AvailableChannels, "Value", "Text"), "Vælg kanal", new { @class = "form-control" })
</div>
<div class="2">
    @Html.DropDownListFor(x => x.SelectedShow, new SelectList(Model.AvailableShows, "Value", "Text"), "Vælg program", new { @class = "form-control" })
</div>

<script type="text/javascript">
    $(function () {
        $("#SelectedChannel").change(function () {
            var val = $(this).val();
            var subItems = "";
            $.getJSON("@Url.Action("GetShows","Podcast")", { name: val }, function (data) {
                $.each(data, function (index, item) {
                    subItems += "<option value='" + item.Value + "'>" + item.Text + "</option>";
                });
                $("#SelectedShow").html(subItems);
            });
        });
    });
</script>

<script type="text/javascript">
    $(function () {
        $("#SelectedShow").change(function () {
            var val = $(this).val();
            window.location.href = '/Podcast/Episodes/' +$("#SelectedChannel").val() + '/' + val;
        });
    });
</script>


@*@{
        if (Model.PodcastFeed != null)
        {
            <h2>@Model.PodcastFeed.Title</h2>
                <p>@Model.PodcastFeed.Description</p>
        }
    }*@

@*<h3>Udsendelser</h3>
    <div class="table-responsive">
        <table class="table-striped">
            <tr>
                <th class="col-md-1">Afspil</th>
                <th class="col-md-8">Beskrivelse</th>
                <th class="col-md-1">Varighed</th>
                <th class="col-md-1">Størrelse</th>
                <th class="col-md-1">Udgivelses dato</th>
            </tr>
            @{
                if (Model.PodcastFeed != null)
                {
                    foreach (var item in Model.PodcastFeed.FeedItems)
                    {
                        <tr>
                            <td>
                                <div class="text-center">
                                    <a href="@item.Url" target="_blank"><i style="font-size: 1.5em;" class="text-center success glyphicon glyphicon-play-circle"></i></a>
                                </div>
                            </td>
                            <td>@item.Summary</td>
                            <td class="text-right">@item.Duration</td>
                            <td class="text-right">@item.Size</td>
                            <td class="text-right">@item.PublishDate.ToString("dd-MM-yyyy")</td>
                        </tr>
                    }
                }
            }
        </table>
    </div>*@
